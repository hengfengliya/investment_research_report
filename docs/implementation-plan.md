# 东方财富研报聚合系统最小实现计划

## 1. 项目目标拆解
- **数据抓取**：周期性获取东方财富四类研报，解析核心字段，并避免重复入库。
- **数据存储**：使用 PostgreSQL（Neon），借助 Prisma 维护表结构与迁移。
- **服务接口**：通过 Hono + Bun 提供列表、详情、同步触发、分类统计等 API。
- **前端展示**：以 React + Vite + TailwindCSS 搭建响应式界面，支持筛选与详情查看。

## 2. 最小可行范围（MVP）
1. 爬虫脚本
   - 支持四个列表页抓取。
   - 解析并保存通用字段 + 常用扩展字段（股票代码、行业、评级等）。
   - 使用 `title + date + org` 作为去重键。
   - 命令行可触发执行，并输出日志。
2. 后端 API
   - `GET /api/reports`：分页 + 筛选 + 关键词模糊匹配。
   - `GET /api/report/:id`：返回单条研报详情。
   - `POST /api/sync`：调用爬虫并返回任务状态（暂定基于密钥校验）。
   - `GET /api/categories`：统计各类别数量。
   - 统一错误处理与基础日志。
3. 前端界面
   - 首页显示最新研报列表与类别筛选入口。
   - 列表页支持条件筛选、搜索、分页。
   - 详情页展示研报信息并提供下载链接。
   - 全站 TailwindCSS 主题，移动端适配。
4. 配置与部署
   - `.env.example` 罗列必需环境变量。
   - `README.md` 说明本地运行与部署步骤。

## 3. 目录与文件约束
- 遵循单层目录 ≤ 8 个文件的原则，必要时拆分子目录。
- 控制单文件行数：前端/脚本/后端 TS 文件不超过 200 行。
- 统一 `src` 下分模块组织，以防循环依赖与冗余。

## 4. 潜在风险与对应措施
- **编码问题**：`PRD.md` 当前存在乱码，后续提供 UTF-8 版本并保留原文件。
- **数据字段缺失**：网页结构变动时，需要调整选择器；计划添加容错日志。
- **部署密钥安全**：在示例中使用占位符，提醒用户通过 Vercel / Neon 控制面板配置。
- **性能扩展**：MVP 不引入缓存，待用户确认后可增加 Edge Cache 或 Redis。

## 5. 下一步行动
1. 初始化 `backend`、`frontend`、`prisma`、`scripts` 等目录骨架。
2. 编写 Prisma 模型并生成客户端。
3. 实现 Hono API 与数据访问层。
4. 实现爬虫脚本并验证数据写入。
5. 搭建前端基础页面。
6. 编写 README 与环境变量模板。

