# 有物投研 · 研报聚合 最小实现计划

## 1. 目标概述
- 数据抓取：周期性获取公开来源的四类研报，解析核心字段，避免重复入库。
- 数据存储：使用 PostgreSQL（Neon），借助 Prisma 维护表结构与迁移。
- 服务接口：通过 Hono + Bun 提供列表、详情、同步触发、分类统计等 API。
- 前端展示：React + Vite + TailwindCSS 搭建响应式界面，支持筛选与详情查看。

## 2. MVP 范围
1) 爬虫脚本
   - 支持四类列表抓取；
   - 保存通用字段与扩展字段（股票代码、行业、评级等）；
   - 使用 `title + date + org` 去重；
   - CLI 可触发执行并输出日志。
2) 后端 API
   - `GET /api/reports`：分页 + 筛选 + 关键词模糊；
   - `GET /api/report/:id`：单条详情；
   - `POST /api/sync`：触发同步（密钥校验）；
   - `GET /api/categories`：分类数量统计；
   - 统一错误处理与基础日志。
3) 前端
   - 首页（列表 + 筛选 + 搜索 + 分页）；
   - 详情页（信息展示、下载/原文链接）；
   - Tailwind 主题，移动端适配；
   - 导航仅保留“首页”。
4) 配置与部署
   - `.env.example` 环境变量模板；
   - README 说明本地运行与部署步骤。

## 3. 代码组织约束
- 单层目录不超过 8 个文件，必要时再拆子目录；
- 单文件行数：前端/脚本/后端 TS 尽量不超过 200 行；
- `src` 下模块化，避免循环依赖与冗余。

## 4. 风险与对策
- 编码与乱码：清理历史乱码文档，统一 UTF-8；
- 字段波动：页面结构变化导致解析失败，增加容错日志与监控；
- 密钥安全：使用 Secrets 管理敏感参数；
- 性能扩展：MVP 不引入缓存，后续按需增加 Edge Cache/Redis。

## 5. 执行步骤
1) 初始化 backend/frontend/prisma/scripts 目录骨架；
2) 编写 Prisma 模型并生成客户端；
3) 实现 Hono API 与数据访问层；
4) 实现爬虫脚本并验证数据写入；
5) 搭建前端页面（列表/详情）；
6) 编写 README 与环境变量模板。

